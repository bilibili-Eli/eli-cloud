<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.client.system.mapper.MenusMapper">
    <resultMap id="MenusVo" type="com.client.system.vo.MenusVo">
        <id column="p_menu_id" property="menuId"/>
        <result column="p_path" property="path"/>
        <result column="p_redirect" property="redirect"/>
        <result column="p_name" property="name"/>
        <result column="p_component" property="component"/>
        <association property="meta" javaType="com.client.system.model.Meta">
            <result column="p_title" property="title"/>
            <result column="p_icon" property="icon"/>
        </association>
        <collection property="children" ofType="com.client.system.vo.MenusVo">
            <id column="menu_id" property="menuId"/>
            <result column="path" property="path"/>
            <result column="redirect" property="redirect"/>
            <result column="name" property="name"/>
            <result column="component" property="component"/>
            <association property="meta" javaType="com.client.system.model.Meta">
                <result column="title" property="title"/>
                <result column="icon" property="icon"/>
            </association>
        </collection>
    </resultMap>
    <select id="selectAll" resultMap="MenusVo">
        SELECT m1.menu_id   AS p_menu_id,
               m1.path      AS p_path,
               m1.redirect  AS p_redirect,
               m1.`name`    AS p_name,
               m1.component AS p_component,
               m1.title     AS p_title,
               m1.icon      AS p_icon,
               m2.menu_id   AS menu_id,
               m2.path      AS path,
               m2.redirect  AS redirect,
               m2.`name`    AS name,
               m2.component AS component,
               m2.title     AS title,
               m2.icon      AS icon
        FROM test_db.menus m1
                 LEFT JOIN test_db.menus m2 ON m2.parent_id = m1.menu_id
        WHERE m1.is_parent = '0'
          AND m2.`status` = '0'
          AND m1.`status` = '0';
    </select>
</mapper>
